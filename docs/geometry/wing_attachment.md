# Wing Attachment

This section defines how wings are attached to the fuselage, including their position, orientation, and optional aerodynamic fairing.

## Overview

A **Wing Attachment** combines the wing geometry with its placement in the airframe. It specifies where the wing root connects to the fuselage and how it is oriented.

## Coordinate System

All attachment coordinates are relative to the `SETUAV_BODY` frame (origin at fuselage nose tip):

- **X+**: Aft (toward tail)
- **Y+**: Right (starboard)
- **Z+**: Up

## Attachment Parameters

### Position

| Parameter | Unit | Description |
| :--- | :--- | :--- |
| **position_x** | `mm` | Longitudinal position along fuselage (distance from nose tip). |
| **position_y** | `mm` | Lateral offset from centerline. Typically non-zero for V-tail or asymmetric configurations. |
| **position_z** | `mm` | Vertical offset from fuselage reference line. Positive values raise the wing. |

### Orientation

| Parameter | Unit | Description |
| :--- | :--- | :--- |
| **pitch_rotation** | `deg` | Rotation around Y-axis (lateral axis). Adjusts wing incidence angle (optional, default: 0). |
| **roll_rotation** | `deg` | Rotation around X-axis (longitudinal axis). Used for dihedral angle or V-tail configurations. Positive rotation tilts the right wing upward (optional, default: 0). |
| **yaw_rotation** | `deg` | Rotation around Z-axis (vertical axis). Creates a global sweep effect for the entire wing (optional, default: 0). |

### Symmetry

| Parameter | Type | Description |
| :--- | :--- | :--- |
| **mirror** | `bool` | If `true`, the wing is mirrored across the XZ-plane (Y=0) to create a symmetric pair. If `false`, only a single wing is placed. |

## Wing-Fuselage Fairing

A **fairing** is an aerodynamic transition surface that smoothly blends the wing root into the fuselage, reducing interference drag.

### Fairing Parameters

| Parameter | Type | Default | Description |
| :--- | :--- | :--- | :--- |
| **scale** | `float` | `1.2` | Uniform scaling factor for the fairing profile. Range: 1.1-1.4. |
| **leading_curve** | `float` | `0.3` | Leading edge curvature: positive = convex (curves outward), negative = concave (curves inward), 0 = linear. Range: -1.0 to 1.0. |
| **trailing_curve** | `float` | `-0.2` | Trailing edge curvature: positive = convex (curves outward), negative = concave (curves inward), 0 = linear. Range: -1.0 to 1.0. |
| **continuity** | `str` | `G2` | Surface continuity: `G0` (positional), `G1` (tangent), or `G2` (curvature). |

### Fairing Geometry

The fairing is automatically generated by:

1. Extracting the wing root profile
2. Scaling it uniformly by the `scale` factor and positioning it to intersect the fuselage
3. Applying curvature control to create convex (outward) or concave (inward) transitions at leading and trailing edges
4. Lofting between profiles with specified continuity
5. Trimming the result against the fuselage surface

**Curvature Control**:

- **Positive curve** (0 to 1.0): Convex transition, curves outward - reduces interference drag
- **Negative curve** (-1.0 to 0): Concave transition, curves inward - creates smoother integration
- **Zero curve**: Linear transition

Typically, leading edges use slight positive curve (convex) while trailing edges use slight negative curve (concave) for optimal aerodynamics.

## Example Configuration

```yaml
wings:
  - tag: "main_wing"
    attachment:
      position_x: 450    # 450mm from nose
      position_y: 0      # Centerline
      position_z: 50     # 50mm above reference
      pitch_rotation: 0  # No incidence offset
      roll_rotation: 2.0 # 2Â° dihedral
      yaw_rotation: 0    # No global sweep
      mirror: true       # Symmetric pair
      fairing:
        scale: 1.2
        leading_curve: 0.3
        trailing_curve: -0.2
        continuity: "G2"
    
    geometry:
      blending:
        ruled: false
        max_degree: 3
        continuity: "G2"
      profiles:
        - position_x: 0
          position_y: 0
          position_z: 0
          chord: 240
          pitch_rotation: 2.0
          airfoil: "naca2412"
        # Additional profiles...

  - tag: "horizontal_stabilizer"
    attachment:
      position_x: 1200   # Near tail
      position_y: 0
      position_z: 120
      pitch_rotation: 0
      roll_rotation: 0
      yaw_rotation: 0
      mirror: true       # Symmetric pair
      fairing:
        scale: 1.15
        leading_curve: 0.2
        trailing_curve: -0.15
        continuity: "G1"
    
    geometry:
      blending:
        ruled: false
        max_degree: 3
        continuity: "G2"
      profiles:
        - position_x: 0
          position_y: 0
          position_z: 0
          chord: 150
          pitch_rotation: 0
          airfoil: "naca0012"
        # Additional profiles...
```
